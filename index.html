<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ARKON • Hub kont i aplikacji</title>
<meta name="description" content="Szybki hub do przełączania między kontami/aplikacjami ARKON. Obsługa GitHub Pages i Netlify.">
<style>
  :root{
    --bg:#0b1020; --grad1:#0a1028; --grad2:#0d1536;
    --ink:#e8edff; --muted:#aeb8da; --line:#22306a;
    --card:#0f1636; --chip:#16245a; --accent:#4cc9f0;
    --ok:#2fbf71; --warn:#ffb84d; --bad:#ff6b6b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,var(--grad1),var(--grad2));color:var(--ink);font:15px/1.55 system-ui,Segoe UI,Roboto,Arial}
  a{color:#cfe0ff;text-decoration:none}
  header{padding:18px 16px;border-bottom:1px solid var(--line);background:#0e1534;position:sticky;top:0;z-index:5}
  h1{margin:0;font-size:22px}
  .muted{color:var(--muted);font-size:13px}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}
  .grid{display:grid;gap:12px}
  @media(min-width:1000px){ .cols-2{grid-template-columns:1fr 1fr} .cols-3{grid-template-columns:repeat(3,1fr)} }
  .card{background:linear-gradient(180deg,#0f1636,#0f1a42);border:1px solid var(--line);border-radius:14px;padding:14px}
  .apps{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
  .app{display:flex;flex-direction:column;gap:10px;padding:14px;border-radius:12px;background:#111a42;border:1px solid #2a3a75}
  .app h3{margin:0;font-size:16px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .pill{display:inline-block;background:#0d1530;border:1px dashed #2b3a77;border-radius:999px;padding:6px 10px;color:#aeb8da;font-size:13px}
  .btn{background:#233261;border:1px solid #3a4ca3;color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn.ghost{background:transparent;border:1px dashed #3a4ca3}
  .btn.ok{background:#194d34;border-color:#2f9762}
  .btn.bad{background:#3a1f2a;border-color:#7b3341}
  input,select{width:100%;background:#0d1530;border:1px solid #28356c;border-radius:10px;padding:8px 10px;color:var(--ink);font:inherit}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th,td{padding:8px 6px;border-bottom:1px solid #1a244d;text-align:left;vertical-align:top}
  th{font-size:12px;color:var(--muted)}
  .right{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}
  .kbd{font:12px/1.2 ui-monospace,Menlo,Consolas,monospace;background:#101735;border:1px solid #2a3777;padding:2px 6px;border-radius:6px;color:#cfe0ff}
  .ok{color:#7ee2ab} .warn{color:#ffd699} .bad-t{color:#ffb1b1}
  .hint{font-size:12px;color:#aeb8da}
</style>
</head>
<body>
<header>
  <h1>ARKON • Hub</h1>
  <div class="muted">Szybkie przełączanie między kontami/aplikacjami. Działa z GitHub Pages oraz Netlify.</div>
</header>

<div class="wrap grid cols-2">
  <!-- LEWA: Kafelki szybkiego startu -->
  <section class="grid">
    <div class="card">
      <div class="row" style="justify-content:space-between">
        <b>Konta/aplikacje</b>
        <span class="hint">Kliknij, aby otworzyć. Linki ustawią się automatycznie po podaniu loginu GitHub lub adresu Netlify.</span>
      </div>
      <div id="apps" class="apps" style="margin-top:8px"></div>
    </div>

    <div class="card">
      <b>Dodaj własne aplikacje</b>
      <div class="hint" style="margin:6px 0 10px">Wpisz „Nazwa” i repo (dla GitHub Pages) albo adres Netlify. Możesz podać oba – powstaną dwa przyciski. Zapis lokalny.</div>
      <table id="tblAdd">
        <thead><tr><th>Nazwa (wyświetlana)</th><th>Repo (GitHub Pages)</th><th>Netlify URL (opcjonalnie)</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="right" style="margin-top:8px">
        <button id="btnAddRow" class="btn ok" type="button">+ Wiersz</button>
        <button id="btnSaveRows" class="btn" type="button">Zapisz listę</button>
        <button id="btnClearRows" class="btn bad" type="button">Wyczyść</button>
      </div>
      <div class="hint" style="margin-top:8px">Po zapisie kafelki pojawią się wyżej. Edytuj później w tej tabeli.</div>
    </div>
  </section>

  <!-- PRAWA: Ustawienia i pomoc -->
  <aside class="grid">
    <div class="card">
      <b>Ustawienia linków</b>
      <div class="grid" style="margin-top:8px;gap:10px">
        <div>
          <label class="hint">Twój login GitHub (małymi literami)</label>
          <input id="ghUser" placeholder="np. mozola-satlawa">
        </div>
        <div class="row">
          <button id="btnApplyUser" class="btn ok" type="button">Ustaw linki</button>
          <button id="btnForgetUser" class="btn ghost" type="button">Wyczyść login</button>
          <span class="pill">Zapamiętane: <b id="memUser">—</b></span>
        </div>
        <div class="hint">Link GitHub Pages będzie miał postać: <span class="kbd">https://USERNAME.github.io/NAZWA-REPO/</span></div>
      </div>
    </div>

    <div class="card">
      <b>Domyślne wpisy (możesz zmienić poniżej)</b>
      <ul class="hint" style="margin:6px 0 0 14px">
        <li><b>arkon-crm</b> — główny CRM</li>
        <li><b>pawel</b> — kopia CRM</li>
        <li><b>kalkulator</b> — kalkulator dotacji</li>
        <li><b>dokumenty</b> — repo ze stroną dokumentów</li>
      </ul>
      <div class="hint" style="margin-top:6px">Jeśli korzystasz z Netlify, po prostu wstaw tu jego adres (np. <span class="kbd">https://arkon-crm.netlify.app/</span>).</div>
    </div>

    <div class="card">
      <b>Podpowiedzi</b>
      <ul class="hint" style="margin:6px 0 0 16px">
        <li><b>GitHub Pages</b>: w każdym repo (np. <i>arkon-crm</i>) włącz <i>Settings → Pages → Deploy from a branch → main /(root)</i>. W katalogu musi być <i>index.html</i>.</li>
        <li><b>Przeklejanie kont</b>: sklonuj repo i zmień tylko nazwę repo oraz pliki z domyślnymi danymi (czat, hasła).</li>
        <li><b>Prywatność</b>: to tylko statyczny hub; nic nie wysyła na serwer. Dane trzymane w <i>localStorage</i>.</li>
      </ul>
    </div>
  </aside>
</div>

<script>
'use strict';

/* ===== helpers ===== */
const $  = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const LS = { user:'arkon_hub_user', rows:'arkon_hub_rows_v1' };

const DEFAULT_APPS = [
  { name:'arkon-crm', repo:'arkon-crm', netlify:'https://arkon-crm.netlify.app/' },
  { name:'pawel',     repo:'pawel',     netlify:'https://pawel.netlify.app/' },
  { name:'kalkulator',repo:'czyste-powietrze-kalkulator', netlify:'' },
  { name:'dokumenty', repo:'arkon-crm', netlify:'', subpath:'dokumenty.html' } // przykład: podstrona w tym samym repo
];

function ghPagesURL(user, repo, subpath){
  if(!user || !repo) return null;
  const base = `https://${user}.github.io/${repo}/`;
  return subpath ? base + subpath.replace(/^\\/?/,'') : base;
}

function loadUser(){ return localStorage.getItem(LS.user)||''; }
function saveUser(v){ if(v) localStorage.setItem(LS.user,v); else localStorage.removeItem(LS.user); $('#memUser').textContent = v||'—'; }

function loadRows(){
  try{ return JSON.parse(localStorage.getItem(LS.rows) || 'null') || DEFAULT_APPS; }
  catch{ return DEFAULT_APPS; }
}
function saveRows(rows){ localStorage.setItem(LS.rows, JSON.stringify(rows)); }

/* ===== render apps ===== */
function renderApps(){
  const user = loadUser();
  $('#memUser').textContent = user || '—';
  const apps = loadRows();
  const box = $('#apps'); box.innerHTML='';
  apps.forEach((app,idx)=>{
    const card = document.createElement('div');
    card.className='app';
    const title = document.createElement('h3');
    title.textContent = app.name || ('Aplikacja '+(idx+1));
    card.appendChild(title);

    const links = document.createElement('div');
    links.className = 'row';

    // GitHub Pages button
    const gh = ghPagesURL(user, app.repo, app.subpath);
    if(gh){
      const a = document.createElement('a');
      a.href = gh; a.target='_blank'; a.rel='noopener';
      a.className='btn'; a.textContent='Otwórz (GitHub Pages)';
      links.appendChild(a);
    }else{
      const s = document.createElement('span');
      s.className='hint'; s.textContent = 'Brak linku Pages (uzupełnij login lub repo).';
      links.appendChild(s);
    }

    // Netlify button
    if(app.netlify){
      const a2 = document.createElement('a');
      a2.href = app.netlify; a2.target='_blank'; a2.rel='noopener';
      a2.className='btn ghost'; a2.textContent='Otwórz (Netlify)';
      links.appendChild(a2);
    }

    card.appendChild(links);

    // meta
    const meta = document.createElement('div');
    meta.className='hint';
    meta.textContent = `repo: ${app.repo||'—'}${app.subpath? ' • sub: '+app.subpath : ''} ${app.netlify? ' • netlify: '+app.netlify : ''}`;
    card.appendChild(meta);

    box.appendChild(card);
  });
}

/* ===== table add/edit ===== */
function renderRowsEditor(){
  const rows = loadRows();
  const tb = document.querySelector('#tblAdd tbody');
  tb.innerHTML='';
  rows.forEach((r,i)=>tb.appendChild(rowEditor(i,r)));
}
function rowEditor(i,r){
  const tr = document.createElement('tr');
  tr.innerHTML = \`
    <td><input value="\${r.name||''}" data-k="name"></td>
    <td><input value="\${r.repo||''}" data-k="repo" placeholder="np. arkon-crm"></td>
    <td><input value="\${r.netlify||''}" data-k="netlify" placeholder="https://..."></td>
    <td class="right">
      <button class="btn ghost" data-act="subpath" type="button">Subpath</button>
      <button class="btn bad" data-act="del" type="button">Usuń</button>
    </td>\`;
  tr.querySelectorAll('input').forEach(inp=>{
    inp.addEventListener('input', ()=>{ r[inp.dataset.k] = inp.value.trim(); });
  });
  tr.querySelector('[data-act="del"]').addEventListener('click', ()=>{
    const rows = loadRows(); rows.splice(i,1); saveRows(rows); renderRowsEditor(); renderApps();
  });
  tr.querySelector('[data-act="subpath"]').addEventListener('click', ()=>{
    const val = prompt('Podstrona (opcjonalnie), np. dokumenty.html lub folder/index.html', r.subpath||'');
    if(val!=null){ r.subpath = val.trim(); const rows=loadRows(); rows[i]=r; saveRows(rows); renderRowsEditor(); renderApps(); }
  });
  return tr;
}

/* ===== events ===== */
$('#btnAddRow').addEventListener('click', ()=>{
  const rows = loadRows();
  rows.push({name:'nowa-aplikacja', repo:'', netlify:''});
  saveRows(rows);
  renderRowsEditor();
});
$('#btnSaveRows').addEventListener('click', ()=>{
  // zbierz z tabeli (na wypadek, gdyby coś nie zapisało się do obiektu)
  const rows = Array.from(document.querySelectorAll('#tblAdd tbody tr')).map(tr=>{
    const g = k=> tr.querySelector('input[data-k="'+k+'"]')?.value.trim() || '';
    return { name:g('name'), repo:g('repo'), netlify:g('netlify') };
  });
  saveRows(rows); renderApps();
  alert('Zapisano listę aplikacji.');
});
$('#btnClearRows').addEventListener('click', ()=>{
  if(confirm('Usunąć wszystkie wpisy i przywrócić domyślne?')){
    saveRows(DEFAULT_APPS.slice());
    renderRowsEditor(); renderApps();
  }
});
$('#btnApplyUser').addEventListener('click', ()=>{
  const v = $('#ghUser').value.trim();
  if(!v){ alert('Podaj login GitHub.'); return; }
  saveUser(v.toLowerCase()); renderApps();
});
$('#btnForgetUser').addEventListener('click', ()=>{ saveUser(''); renderApps(); });

/* ===== init ===== */
(function init(){
  const u = loadUser(); $('#ghUser').value = u||''; $('#memUser').textContent = u||'—';
  if(!localStorage.getItem(LS.rows)){ saveRows(DEFAULT_APPS.slice()); }
  renderApps();
  renderRowsEditor();
})();
</script>
</body>
</html>
